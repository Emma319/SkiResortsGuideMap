(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{27:function(e,t,n){e.exports=n(63)},32:function(e,t,n){},59:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(22),r=n.n(i),s=n(65),l=(n(32),n(15)),c=n.n(l),u=n(23),d=n(26),m=n(7),h=n(8),p=n(12),g=n(9),f=n(13),v=n(2),w=n(10),b=n.n(w);var k=function(e){var t=e.handleIntroToggle,n=e.handleListToggle;return o.a.createElement("header",{className:"App-header"},o.a.createElement("section",{"aria-labelledby":"aria-neighborhood-map-home"},o.a.createElement("h1",{id:"aria-neighborhood-map-home",className:"header-title"},o.a.createElement("a",{href:"/"},"Lake Tahoe Ski Resorts Map"))),o.a.createElement("section",{id:"toggle-btn",className:"header-btn"},o.a.createElement("button",{className:"intro-btn","aria-labelledby":"toggle-btn",onClick:t,onKeyPress:t},"Introduction"),o.a.createElement("button",{className:"list-btn","aria-labelledby":"toggle-btn",onClick:n,onKeyPress:n},"List")))};var E=function(e){var t=e.introduction,n=e.handleIntroToggle;return o.a.createElement("div",{className:"intro-section"},o.a.createElement("h2",{className:"intro-title","aria-labelledby":"aria-intro-section",tabIndex:"0"},o.a.createElement("span",null,t.name)),o.a.createElement("label",{id:"aria-intro-section",className:"aria-label"},"Lake Tahoe Introduction"),o.a.createElement("a",{className:"intro-close",onClick:n,onKeyPress:n},"Close Introduction Info"),o.a.createElement("div",{className:"intro-synopsis"},o.a.createElement("p",null,t.synopsis)),o.a.createElement("a",{className:"intro-detail",href:t.url},"More on Wikipedia \xbb"))},y=n(24),O=n(25),I=n.n(O),T=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(n=Object(p.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(o)))).state={query:""},n.updateQuery=function(e){n.setState({query:e})},n.clearQuery=function(){n.setState({query:""})},n}return Object(f.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e,t=this,n=this.props,a=n.markers,i=n.locations,r=n.showMarkerInfo,s=this.state.query;if(s){var l=new RegExp(I()(s),"i");e=i.filter(function(e){return l.test(e.name)}),a.forEach(function(e){l.test(e.title)?e.setVisible(!0):e.setVisible(!1)})}else e=i,a.forEach(function(e){return e.setVisible(!0)});return e.sort(b()("name")),o.a.createElement("nav",{className:"list-locations"},o.a.createElement("div",{className:"search-locations"},o.a.createElement(y.DebounceInput,{minLength:1,debounceTimeout:200,autoFocus:!0,className:"search-locations-input","aria-labelledby":"filter",type:"text",placeholder:"Search Ski Resorts",value:s,onChange:function(e){return t.updateQuery(e.target.value)}})),e.length!==i.length&&o.a.createElement("div",{className:"showing-locations"},o.a.createElement("span",null,"Now showing ",e.length," of ",i.length," total"),o.a.createElement("button",{onClick:this.clearQuery},"Show all")),o.a.createElement("ol",{className:"location-list","aria-labelledby":"aria-location-list"},e.map(function(e){return o.a.createElement("li",{key:e.id,className:"location-list-item","aria-labelledby":e.name,tabIndex:"0",role:"button",onClick:function(){return r(e)},onKeyPress:function(){return r(e)}},o.a.createElement("p",{className:"location-title"},e.name))})),o.a.createElement("label",{id:"aria-location-list",className:"aria-label"},"Locations List"))}}]),t}(a.Component);var M=function(e){var t=e.listOpen,n=e.markers,a=e.locations,i=e.showMarkerInfo;return o.a.createElement("main",null,o.a.createElement("section",{id:"map-container","aria-labelledby":"aria-map",role:"application"},o.a.createElement("div",{id:"map","aria-labelledby":"aria-map"}),o.a.createElement("label",{id:"aria-map",className:"aria-label"},"Interactive Map")),t&&o.a.createElement("section",{id:"nav-container"},o.a.createElement(T,{markers:n,locations:a,showMarkerInfo:i})))};var L=function(e){return o.a.createElement("footer",{id:"footer","aria-labelledby":"aria-footer"},o.a.createElement("label",{id:"aria-footer",className:"aria-label"},"Footer: Copyright Statement"),"Copyright (c) 2018 ",o.a.createElement("a",{href:"/"},o.a.createElement("strong",null,"Lake Tahoe Ski Resorts Map"))," All Rights Reserved.")},N=n(6),P=n.n(N);function S(){return this.googleMapPromise||(this.googleMapPromise=new Promise(function(e){window.resolveGoogleMapPromise=function(){e(window.google),delete window.resolveGoogleMapPromise},window.gm_authFailure=function(){alert("Error: Authentication failure to load Google Maps")};var t=document.createElement("script");t.src="https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyBqGLhaozeD1dM_yjBJceWe4-Pw6DID5Qg","&callback=resolveGoogleMapPromise"),t.async=!0,t.defer=!0,document.body.appendChild(t)})),this.googleMapPromise}function j(e){return new Promise(function(t){var n="https://api.foursquare.com/v2/venues/".concat(e,"/photos?"),a={client_id:"JITY1KOHGHGZ4JO5OVQG5P1O4EFQEBNFW5E3OZZV1T0OOIRP",client_secret:"WTMRA5V5MPGURXNIIT4WUK13FOAZJFO5V40CWB5PVTKNCOAL",VENUE_ID:e,limit:1,v:"20182507"};P.a.get(n+new URLSearchParams(a)).then(function(e){var n=e.data.response.photos.items[0];return t(n.prefix+"300x300"+n.suffix)}).catch(function(e){console.log("Error get venue photo!! "+e)})})}n(59);var C=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(p.a)(this,Object(g.a)(t).call(this,e))).renderMap=function(){var e;Promise.all([S(),new Promise(function(e){P.a.get("https://api.foursquare.com/v2/venues/search?"+new URLSearchParams({client_id:"JITY1KOHGHGZ4JO5OVQG5P1O4EFQEBNFW5E3OZZV1T0OOIRP",client_secret:"WTMRA5V5MPGURXNIIT4WUK13FOAZJFO5V40CWB5PVTKNCOAL",query:"ski resort",ll:"39.0925, -120.0334",limit:6,v:"20182507"})).then(function(t){return e(t.data.response.venues)}).catch(function(e){console.log("Error getting venues!! "+e),alert("Something wrong when loading locations...")})}),(e="Lake Tahoe",new Promise(function(t){var n={origin:"*",format:"json",action:"query",titles:e,prop:"pageimages|description|extracts",piprop:"name|thumbnail",pithumbsize:500,exsentences:5,explaintext:1};P.a.get("https://en.wikipedia.org/w/api.php?"+new URLSearchParams(n)).then(function(e){return t(e.data.query.pages[140899])}).catch(function(e){console.log("Error getting wiki!! "+e),alert("Something wrong when loading wikipedia...")})})),function(e){return new Promise(function(t){var n={origin:"*",format:"json",action:"opensearch",limit:1,search:e};P.a.get("https://en.wikipedia.org/w/api.php?"+new URLSearchParams(n)).then(function(e){return t(e.data[3][0])}).catch(function(e){console.log("Error getting wikiURL!! "+e),alert("Something wrong when loading wikipedia URL...")})})}("Lake Tahoe")]).then(function(e){var t=Object(d.a)(e,4),a=(t[0],t[1]),o=t[2],i=t[3];n.setState({venues:a}),n.setState({introduction:{id:o.pageid,name:o.title,description:o.description,synopsis:o.extract,url:i,thumbnail:o.thumbnail.source}}),n.initMap(),n.mapStyle()}).catch(function(e){console.log("Error render map!! "+e),alert("Error loading page...")})},n.initMap=function(){var e=n.state,t=e.infoBoxes,a=e.markers,o=e.locations,i=e.introduction,r={lat:39.092507,lng:-120.033492},s=new window.google.maps.Map(document.getElementById("map"),{center:r,zoom:10,mapTypeId:"terrain"});n.setState({map:s});var l=new window.google.maps.InfoWindow;n.setState({infowindow:l});var c=new window.google.maps.Marker({position:r,map:s,title:"Lake Tahoe",id:"Lake_Tahoe",animation:window.google.maps.Animation.DROP}),u='<div class="venueBlock"><div class="venueIcon"><img src="'+i.thumbnail+'" alt="'+i.name+'" width="200" height="200" /></div><div class="venueDetails"><div class="venueName"><a href="https://www.google.com/search?q=lake+tahoe">'+i.name+'</a></div><div class="venueDescription">'+i.description+"</div></div></div>";t.push({id:c.id,name:c.title,content:u}),c.addListener("click",function(){l.setContent(u),l.open(s,c),s.setZoom(11),s.setCenter(c.position)}),n.state.venues.sort(b()("name")),n.state.venues.forEach(function(e){var t=new window.google.maps.Marker({position:{lat:e.location.lat,lng:e.location.lng},map:s,title:e.name,venue:e,id:e.id,animation:window.google.maps.Animation.DROP});n.getMarkerInfo(t),window.google.maps.event.addListener(t,"click",function(){n.showMarkerInfo(e)}),a.push(t),o.push(e)})},n.state={map:"",infowindow:"",infoBoxes:[],markers:[],locations:[],introduction:"",listOpen:!1,introOpen:!1},n.mapStyle=n.mapStyle.bind(Object(v.a)(Object(v.a)(n))),n.handleListToggle=n.handleListToggle.bind(Object(v.a)(Object(v.a)(n))),n.handleIntroToggle=n.handleIntroToggle.bind(Object(v.a)(Object(v.a)(n))),n.handleOutsideClick=n.handleOutsideClick.bind(Object(v.a)(Object(v.a)(n))),n.showMarkerInfo=n.showMarkerInfo.bind(Object(v.a)(Object(v.a)(n))),n.markerAnimation=n.markerAnimation.bind(Object(v.a)(Object(v.a)(n))),n}var n;return Object(f.a)(t,e),Object(h.a)(t,[{key:"componentWillMount",value:function(){document.removeEventListener("click",this.handleOutsideClick,!1),S()}},{key:"componentDidMount",value:function(){this.renderMap()}},{key:"mapStyle",value:function(){window.innerWidth>560&&(this.state.listOpen||document.getElementById("map-container").style.setProperty("--map_container-width","100%"))}},{key:"handleListToggle",value:function(){this.setState(function(e){return{listOpen:!e.listOpen}}),this.mapStyle()}},{key:"handleIntroToggle",value:function(){this.state.introOpen?document.removeEventListener("click",this.handleOutsideClick,!1):document.addEventListener("click",this.handleOutsideClick,!1),this.setState(function(e){return{introOpen:!e.introOpen}})}},{key:"handleOutsideClick",value:function(e){this.node.contains(e.target)||this.handleIntroToggle()}},{key:"showMarkerInfo",value:function(e){var t=this.state,n=t.map,a=t.infowindow,o=t.infoBoxes,i=t.markers.filter(function(t){return t.id===e.id})[0],r=o.filter(function(t){return t.id===e.id})[0];i&&r&&(this.markerAnimation(i),a.setContent(r.content),a.open(n,i),n.setZoom(11),n.setCenter(i.position),window.innerWidth<560&&this.handleListToggle(),window.google.maps.event.addListener(n,"click",function(){a.close()}))}},{key:"markerAnimation",value:function(e){null!==e.getAnimation()?e.setAnimation(null):e.setAnimation(window.google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},1800)}},{key:"getMarkerInfo",value:(n=Object(u.a)(c.a.mark(function e(t){var n,a,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(t.id);case 2:n=e.sent,a="https://www.google.com/search?q="+t.title.replace(/ /g,"+"),o='<div class="venueBlock"><div class="venueIcon"><img src="'+n+'" alt="'+t.title+'" width="200" height="200" /></div><div class="venueDetails"><div class="venueName"><a href="'+a+'">'+t.title+'</a></div><div class="venueAddress">'+t.venue.location.formattedAddress[0]+'</div><div class="venueAddress">'+t.venue.location.formattedAddress[1]+"</div></div></div>",this.state.infoBoxes.push({id:t.id,name:t.title,content:o});case 6:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.state,n=t.listOpen,a=t.introOpen,i=t.locations,r=t.markers,s=t.introduction;return o.a.createElement("div",{className:"App"},o.a.createElement(k,{handleListToggle:this.handleListToggle,handleIntroToggle:this.handleIntroToggle}),a&&o.a.createElement("section",{id:"intro-container",ref:function(t){e.node=t}},o.a.createElement(E,{introduction:s,handleIntroToggle:this.handleIntroToggle})),o.a.createElement(M,{listOpen:n,markers:r,locations:i,showMarkerInfo:this.showMarkerInfo}),o.a.createElement(L,null))}}]),t}(a.Component),A=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function R(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available; please refresh."),t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t.onSuccess&&t.onSuccess(e)))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}r.a.render(o.a.createElement(s.a,null,o.a.createElement(C,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/SkiResortsGuideMap",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/SkiResortsGuideMap","/service-worker.js");A?(function(e,t){fetch(e).then(function(n){404===n.status||-1===n.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):R(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):R(t,e)})}}()}},[[27,2,1]]]);
//# sourceMappingURL=main.25906404.chunk.js.map